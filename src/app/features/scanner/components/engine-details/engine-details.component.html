<div class="bg-slate-800/30 rounded-xl p-4">
  <!-- Header (clickable) -->
  <h3 
    class="text-xl font-semibold text-white flex items-center justify-between gap-2 cursor-pointer select-none"
    (click)="isCollapsed = !isCollapsed"
  >
    <span class="flex items-center gap-2">
      <i class="fas fa-list-ul text-purple-400"></i>
      Detailed Engine Results
    </span>
    <i 
      class="fas transition-transform duration-300"
      [ngClass]="{
        'fa-chevron-down': isCollapsed,
        'fa-chevron-up': !isCollapsed
      }"
    ></i>
  </h3>

  <!-- Collapsible content -->
  <div 
    class="transition-all duration-300 ease-in-out overflow-hidden"
    [style.maxHeight]="isCollapsed ? '0px' : '800px'"
  >
    <div class="max-h-96 overflow-y-auto scrollbar-hidden space-y-2 mt-2">
      <div 
        *ngFor="let key of (engines | keyvalue)" 
        class="flex justify-between items-center p-3 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors duration-200"
      >
        <span class="font-medium text-slate-200 flex items-center gap-2">
          <i class="fas fa-cog text-slate-400 text-sm"></i>
          {{ key.value.engine_name }}
        </span>
        <span 
          class="px-3 py-1 rounded-full text-sm font-semibold flex items-center gap-1"
          [ngClass]="{
            'bg-green-500/20 text-green-300 border border-green-500/30': key.value.category === 'harmless',
            'bg-slate-500/20 text-slate-300 border border-slate-500/30': key.value.category === 'undetected',
            'bg-yellow-500/20 text-yellow-300 border border-yellow-500/30': key.value.category === 'suspicious',
            'bg-red-500/20 text-red-300 border border-red-500/30': key.value.category === 'malicious'
          }"
        >
          <i class="fas text-xs" 
            [ngClass]="{
              'fa-check': key.value.category === 'harmless',
              'fa-question': key.value.category === 'undetected',
              'fa-exclamation': key.value.category === 'suspicious',
              'fa-times': key.value.category === 'malicious'
            }">
          </i>
          {{ key.value.result || 'N/A' }}
        </span>
      </div>
    </div>
  </div>
</div>
